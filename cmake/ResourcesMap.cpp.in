// This file is generated by nsx resources generator

#include <fstream>
#include <sstream>
#include <stdexcept>

#include "Path.h"
#include "ResourcesMap.h"


namespace nsx {

std::map<std::pair<std::string,std::string>,resource_function> resources_map = {
};

const std::map<std::pair<std::string,std::string>,resource_function>& resourcesMap()
{
    return resources_map;
}

YAML::Node findResource(const std::pair<std::string,std::string>& resource)
{
    auto it = resources_map.find(resource);

    if (it == resources_map.end()) {
        throw std::runtime_error("Unknown resource: "+resource.first+"/"+resource.second);
    }

    auto user_resource_dir = buildPath({applicationDataPath(),resource.first});
    auto user_resource_path = buildPath({user_resource_dir,resource.second+".yml"});
    if (!fileExists(user_resource_path)) {
        makeDirectory(user_resource_dir);
        std::ofstream fout(user_resource_path);
        fout << it->second();
        fout.close();
    }

    return YAML::LoadFile(user_resource_path);
}

std::map<std::string,std::string> resourcesTypes()
{
    std::map<std::string,std::string> resources_types;
    
    for (auto p : resources_map) {
        resources_types.insert(std::make_pair(p.first.first,p.first.second));
    }

    return resources_types;
}

} // end namespace nsx